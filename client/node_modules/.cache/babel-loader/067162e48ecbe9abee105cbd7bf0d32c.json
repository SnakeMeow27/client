{"ast":null,"code":"import _objectSpread from\"C:/Users/danak/WebstormProjects/untitled/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/Users/danak/WebstormProjects/untitled/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/danak/WebstormProjects/untitled/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/danak/WebstormProjects/untitled/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"C:/Users/danak/WebstormProjects/untitled/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/danak/WebstormProjects/untitled/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{makeAutoObservable}from\"mobx\";import{deleteDeviceFromBasket}from\"../http/deviceAPI\";var BasketStoreStore=/*#__PURE__*/function(){function BasketStoreStore(){_classCallCheck(this,BasketStoreStore);this._totalPrice=0;this._basket=[];makeAutoObservable(this);}_createClass(BasketStoreStore,[{key:\"setDeleteItemBasket\",value:function(){var _setDeleteItemBasket=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(application){var _this=this;var isAuth,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isAuth=_args.length>1&&_args[1]!==undefined?_args[1]:false;if(!isAuth){_context.next=6;break;}_context.next=4;return deleteDeviceFromBasket(application.id).then(function(){_this._basket=_this._basket.filter(function(item){return item.id!==application.id;});_this._totalPrice-=application.price*application.count;});case 4:_context.next=9;break;case 6:this._basket=this._basket.filter(function(item){return item.id!==application.id;});this._totalPrice-=application.price*application.count;localStorage.setItem(\"basket\",JSON.stringify(this._basket));case 9:case\"end\":return _context.stop();}}},_callee,this);}));function setDeleteItemBasket(_x){return _setDeleteItemBasket.apply(this,arguments);}return setDeleteItemBasket;}()},{key:\"setBasket\",value:function setBasket(item){var isAuth=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var checkApplicationInBasket=this._basket.findIndex(function(application){return application.id===item.id;});if(checkApplicationInBasket<0){this._basket=[].concat(_toConsumableArray(this._basket),[_objectSpread({count:1},item)]);var totalPrice=0;this._basket.forEach(function(application){return totalPrice+=Number(application.price*application.count);});this._totalPrice=totalPrice;}if(!isAuth){localStorage.setItem(\"basket\",JSON.stringify(this._basket));console.log(\"Не зарегистрирован\");}}},{key:\"setDeleteAllDeviceFromBasket\",value:function setDeleteAllDeviceFromBasket(){this._totalPrice=0;return this._basket=[];}},{key:\"setCountDevice\",value:function setCountDevice(applicationId,action){var isAuth=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var itemInd=this._basket.findIndex(function(item){return item.id===applicationId;});var itemInState=this._basket.find(function(device){return device.id===applicationId;});if(action===\"+\"){var newItem=_objectSpread(_objectSpread({},itemInState),{},{count:++itemInState.count});this._basket=[].concat(_toConsumableArray(this._basket.slice(0,itemInd)),[newItem],_toConsumableArray(this._basket.slice(itemInd+1)));}else{var _newItem=_objectSpread(_objectSpread({},itemInState),{},{count:itemInState.count===1?1:--itemInState.count});this._basket=[].concat(_toConsumableArray(this._basket.slice(0,itemInd)),[_newItem],_toConsumableArray(this._basket.slice(itemInd+1)));}if(!isAuth){localStorage.setItem(\"basket\",JSON.stringify(this._basket));}var totalPrice=0;this._basket.forEach(function(application){return totalPrice+=Number(application.price*application.count);});this._totalPrice=totalPrice;}},{key:\"resetBasket\",value:function resetBasket(){this._basket=[];this._totalPrice=0;localStorage.removeItem('application');}},{key:\"Basket\",get:function get(){return this._basket;}},{key:\"Price\",get:function get(){return this._totalPrice;}}]);return BasketStoreStore;}();export{BasketStoreStore as default};","map":{"version":3,"names":["makeAutoObservable","deleteDeviceFromBasket","BasketStoreStore","_totalPrice","_basket","application","isAuth","id","then","filter","item","price","count","localStorage","setItem","JSON","stringify","checkApplicationInBasket","findIndex","totalPrice","forEach","Number","console","log","applicationId","action","itemInd","itemInState","find","device","newItem","slice","removeItem"],"sources":["C:/Users/danak/WebstormProjects/untitled/client/src/store/BasketStore.js"],"sourcesContent":["import {makeAutoObservable} from \"mobx\";\r\nimport {deleteDeviceFromBasket} from \"../http/deviceAPI\";\r\n\r\nexport default class BasketStoreStore {\r\n    constructor() {\r\n        this._totalPrice = 0;\r\n        this._basket = [];\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    async setDeleteItemBasket(application, isAuth = false) {\r\n        if(isAuth) {\r\n            await deleteDeviceFromBasket(application.id).then(() => {\r\n                this._basket = this._basket.filter(item => item.id !== application.id);\r\n                this._totalPrice -=  application.price * application.count;\r\n            });\r\n        } else {\r\n            this._basket = this._basket.filter(item => item.id !== application.id);\r\n            this._totalPrice -=  application.price * application.count;\r\n\r\n            localStorage.setItem(\"basket\", JSON.stringify(this._basket));\r\n        }\r\n    }\r\n\r\n    setBasket(item, isAuth =false) {\r\n        const checkApplicationInBasket = this._basket.findIndex(application => application.id === item.id);\r\n        if(checkApplicationInBasket < 0) {\r\n            this._basket = [...this._basket, { count: 1, ...item}];\r\n            let totalPrice = 0;\r\n            this._basket.forEach(application => totalPrice += Number(application.price * application.count));\r\n            this._totalPrice = totalPrice;\r\n        }\r\n\r\n        if(!isAuth) {\r\n            localStorage.setItem(\"basket\", JSON.stringify(this._basket));\r\n            console.log(\"Не зарегистрирован\")\r\n        }\r\n    }\r\n\r\n    setDeleteAllDeviceFromBasket() {\r\n        this._totalPrice = 0;\r\n        return this._basket = [];\r\n    }\r\n\r\n    setCountDevice(applicationId, action, isAuth = false) {\r\n        const itemInd = this._basket.findIndex(item => item.id === applicationId);\r\n        const itemInState = this._basket.find(device => device.id === applicationId);\r\n        if (action === \"+\") {\r\n            const newItem = {\r\n                ...itemInState,\r\n                count: ++itemInState.count\r\n            }\r\n            this._basket = [...this._basket.slice(0, itemInd), newItem, ...this._basket.slice(itemInd + 1)]\r\n        } else {\r\n            const newItem = {\r\n                ...itemInState,\r\n                count: itemInState.count === 1 ? 1 : --itemInState.count\r\n            }\r\n            this._basket = [...this._basket.slice(0, itemInd), newItem, ...this._basket.slice(itemInd + 1)]\r\n        }\r\n\r\n        if(!isAuth) {\r\n            localStorage.setItem(\"basket\", JSON.stringify(this._basket));\r\n        }\r\n\r\n        let totalPrice = 0;\r\n        this._basket.forEach(application => totalPrice += Number(application.price * application.count));\r\n        this._totalPrice = totalPrice;\r\n    }\r\n\r\n    resetBasket() {\r\n        this._basket = [];\r\n        this._totalPrice = 0;\r\n        localStorage.removeItem('application');\r\n    }\r\n\r\n\r\n    get Basket() {\r\n        return this._basket;\r\n    }\r\n\r\n    get Price() {\r\n        return this._totalPrice;\r\n    }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}